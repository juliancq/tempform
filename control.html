<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Control ORL</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <style>
        .correcta{
            background-color: #c4fdc4 !important;
        }

        .incorrecta{
            background-color: #fdc4c4 !important;
        }
    </style>
</head>
<body>
    <table class="table puntuaciones">
        <thead>
            <tr>
                <th style="width: 2em"></th>
                <th>Participante</th>
                <th>Email</th>                
                <th style="width: 1em; text-align: center">#1</th>
                <th style="width: 1em; text-align: center">#2</th>
                <th style="width: 1em; text-align: center">#3</th>
                <th style="width: 1em; text-align: center">#4</th>
                <th style="width: 1em; text-align: center">#5</th>
                <th>Puntos</th>
            </tr>
        </thead>
        <tbody>
            
        </tbody>
    </table>
</body>
</html>
<script>
    const correctas = ["a", "b", "c", "d", "e"];
    let participantes = [];
    
    getData();

    function getData(){
        fetch("getRegistros.jsp")
        .then(r => r.json())
        .then(r => {
            
            participantes = r.registros;
    
            cargarTabla(participantes.sort((a,b) => {
                    
                    return a.cantCorrectas > b.cantCorrectas ? -1 : 1; 
                })
            );
        });
    }


    function cargarTabla(data){

        let html = "";

        data.forEach(participante => {
            html += `<tr>
                        <td>${participante.hpc == 0 ? "" : "<img src='logo.gif' style='width: 45px;'>"}</td>
                        <td>${participante.apellido}, ${participante.nombre}</td>
                        <td>${participante.email}</td>
                        <td class="${participante.respuestas[0] == correctas[0] ? "correcta" : "incorrecta"}" style="text-align:center">${participante.respuestas[0]}</td>
                        <td class="${participante.respuestas[1] == correctas[1] ? "correcta" : "incorrecta"}" style="text-align:center">${participante.respuestas[1]}</td>
                        <td class="${participante.respuestas[2] == correctas[2] ? "correcta" : "incorrecta"}" style="text-align:center">${participante.respuestas[2]}</td>
                        <td class="${participante.respuestas[3] == correctas[3] ? "correcta" : "incorrecta"}" style="text-align:center">${participante.respuestas[3]}</td>
                        <td class="${participante.respuestas[4] == correctas[4] ? "correcta" : "incorrecta"}" style="text-align:center">${participante.respuestas[4]}</td>
                        
                        <td>${participante.cantCorrectas}</td>
                    </tr>`;
        });

        document.querySelector("tbody").innerHTML = html;
    }
</script>